# README

This example demonstrates streaming to an Nvidia GPU using Nvidia GPUdirect RDMA.
GPUdirect RDMA is only supported by professional GPU, specified as GPUDirect
in datasheet.

# Default behavior

The *default* behavior of the example application is to receive 10000 buffers
on each channel using an integrated periodic trigger. The input signal is a
ramp generated by a *test pattern generator*. To acquire ADC data,
set`TEST_PATTERN_SOURCE` to `ADQ_TEST_PATTERN_SOURCE_DISABLE` (disabled) in
the settings file `settings.py`.


# Structure

The application can be broken down into six stages:

1. GPU identification and initialization
2. Digitizer identification
3. Digitizer configuration (configuration parameters are located in the header file
   `settings.py`)
4. GPU buffer allocation
5. Data acquisition
6. Summary and cleanup

The source code includes comments to highlight and explain important actions.

# Compilation

* Install Nvidia drivers.
* Install Cuda
* Build gdrdrv: ./adq3_data_transfer_gpu_nvidia/gdrcopy$ make config driver lib lib_install && ldconfig
* Load gdrdrv: .../adq3_data_transfer_gpu_nvidia/gdrcopy$ sudo ./insmod.sh
* Run example .../adq3_data_transfer_gpu_nvidia$ python streaming_nvidia.py


# Performance

Sustained throughput above 7,3 GB/s has been measured in our test system with
this demo. Maximum throughput will depend on:
* Hardware
* System settings
* Transfer buffer size (bigger is better)
* Record length (512 < samples may have some impact)

These dependencies may change in future releases.
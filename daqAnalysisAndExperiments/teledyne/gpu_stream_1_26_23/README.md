# README

This example demonstrates streaming to an Nvidia GPU using Nvidia GPUdirect RDMA.
GPUdirect RDMA is only supported by professional GPU, specified as GPUDirect
in datasheet.

# Default behavior

The *default* behavior of the example application is to receive 1000 buffers
on each channel using an integrated periodic trigger. The input signal is a
ramp generated by a *test pattern generator*. To acquire ADC data,
set`TEST_PATTERN_SOURCE` to `ADQ_TEST_PATTERN_SOURCE_DISABLE` (disabled) in
the header file `Settings.h`.


# Structure

The application can be broken down into six stages:

1. GPU identification and initialization
2. ADQ identification
3. ADQ configuration (configuration parameters are located in the header file
   `settings.h`)
4. GPU buffer allocation
5. Data acquisition
6. Summary and cleanup

The source code includes comments to highlight and explain important actions.

# Compilation

* Install Nvidia drivers.
* Install Cuda, including examples
* Build gdrdrv: .../data_transfer_gpu_nvidia/source/gdrdrv$ make
* Build example: .../data_transfer_gpu_nvidia/source$ make,
   you may have to update the specified cuda version in the makefile
* Load gdrdrv: .../data_transfer_gpu_nvidia/source$ sudo ./insmod.sh
* Run example .../data_transfer_gpu_nvidia/source$ ./streaming_nvidia


# Performance

Sustained throughput above 7,4 GB/s has been measured in our test system with
this demo. Maximum throughput will depend on:
* Hardware
* System settings
* Transfer buffer size (bigger is better)
* Record length (512 < samples may have some impact)

These dependencies may change in future releases

